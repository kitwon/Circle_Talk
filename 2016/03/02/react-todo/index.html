<!DOCTYPE html><html><head><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1.0,  user-scalable=0" name="viewport"><script src="/Circle_Talk/js/vendor/modernizr-2.6.2.min.js"></script><link rel="stylesheet" href="/Circle_Talk/css/index.min.css"></head><body><nav class="main-nav"><div class="container"><a class="btn menu"><span class="icon-bar"></span></a><button class="pull-right nav-button"><div class="graph-pos"><div class="sun"></div></div><div><div>Day</div><div>2016/04/10</div></div></button></div></nav><div class="post-side-bar"><div class="tab-btn"><button class="active">文章目录</button><button>站点导航</button></div><div class="tab-content"><div id="panel1" class="side-bar-panel active"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#小科普"><span class="nav-number">1.</span> <span class="nav-text">小科普</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Demo功能需求"><span class="nav-number">2.</span> <span class="nav-text">Demo功能需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#开始"><span class="nav-number">3.</span> <span class="nav-text">开始</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#配置webpack"><span class="nav-number">3.1.</span> <span class="nav-text">配置webpack</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#上代码"><span class="nav-number">3.2.</span> <span class="nav-text">上代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#App生命-state"><span class="nav-number">3.3.</span> <span class="nav-text">App生命 - state</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#其他组件"><span class="nav-number">3.4.</span> <span class="nav-text">其他组件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#总结"><span class="nav-number">4.</span> <span class="nav-text">总结</span></a></li></ol></div><div id="panel2" class="side-bar-panel"><ul class="post-side-list"><li><div class="head"><img src="/Circle_Talk/img/head.jpg" class="img-responsive"></div></li><li class="overview"><a><div>2</div><div>日志</div></a><a class="m"><div>2</div><div>分类</div></a><a><div>4</div><div>标签</div></a></li><li><a href="/Circle_Talk" class="item"><i class="ion-help-buoy"></i><span>Home</span></a><a href="/Circle_Talk/archives" class="item m"><i class="ion-nuclear"></i><span>Archives</span></a><a href="//github.com/kitwon" class="item"><i class="ion-social-github"></i><span>Github</span></a></li></ul></div></div><div class="cp"><div>©   2015 - 2016   Kit</div><div><span>power by </span><span><a href="//hexo.io">hexo.</a></span><span>Design By Kit.</span></div></div></div><div class="post-black-cover"></div><main class="post-container"><div class="post"><header class="post-header"><h1 class="post-title">React-todo demo</h1><section class="post-meta"><i class="ion-ios-clock-outline"></i><time class="post-date">Mar 2, 2016</time><span class="dot-sep">·</span><i class="ion-ios-pricetags-outline"></i><a href="/Circle_Talk/tags/React/">React</a><a href="/Circle_Talk/tags/Webpack/">Webpack</a><a href="/Circle_Talk/tags/js框架/">js框架</a></section></header><article class="content"><p>好久之前做得一个todo demo，使用了最近较火的react和webpack，由于公司电脑各种不能装，所以没用上es6（各种限制太惨了），在这顺便做个记录，年纪大记性太差了。</p>
<a id="more"></a>
<h3 id="小科普"><a href="#小科普" class="headerlink" title="小科普"></a>小科普</h3><p>什么是React? 按官方解释，框架属于MVC中的view层，由于其设计思想独特，性能出众，逻辑简单，所以上年开始越来越多人关注。<br>至于Webpack，各位官人从名字应该可以猜出，是个打包工具，但又不止是个打包工具，是一个支持模块化的打包工具，两个字就可以形容它的优点了，就是暴力，究竟有多暴力，下面demo就为各位官人揭晓！</p>
<h3 id="Demo功能需求"><a href="#Demo功能需求" class="headerlink" title="Demo功能需求"></a>Demo功能需求</h3><ul>
<li>input输入内容，回车键或按钮增加一条todo</li>
<li>checkbox添加完成状态</li>
<li>移动到列表时显示删除</li>
<li>显示todo总数和已经完成数</li>
<li>list全选</li>
<li>清除已完成</li>
<li>添加动画效果</li>
</ul>
<h3 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h3><p>开始需要npm安装一下等下要用的packages，如果是checkout我的demo，就动动手指头，install一下，我的demo地址是<a href="https://github.com/kitwon/react-todo" target="_blank" rel="external">https://github.com/kitwon/react-todo</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$npm</span> install</span><br></pre></td></tr></table></figure></p>
<h4 id="配置webpack"><a href="#配置webpack" class="headerlink" title="配置webpack"></a>配置webpack</h4><p>所有东西安装完成之后首先就是配置<a href="http://webpack.github.io/docs/" target="_blank" rel="external">webpack</a><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	entry : <span class="string">"./src/entry.js"</span>,</span><br><span class="line">	output : &#123;</span><br><span class="line">		path : path.join(__dirname, <span class="string">"out"</span>),</span><br><span class="line">		publicPath : <span class="string">"./out/"</span>,</span><br><span class="line">		filename : <span class="string">"bundle.js"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	externals : &#123;</span><br><span class="line">		react : <span class="string">"React"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="built_in">module</span> : &#123;</span><br><span class="line">		loaders : [</span><br><span class="line">			&#123; test : <span class="regexp">/\.js$/</span>, loader : <span class="string">"jsx"</span>,include: <span class="regexp">/src/</span> &#125;,</span><br><span class="line">			&#123; test : <span class="regexp">/\.css$/</span>, loader : <span class="string">"style!css"</span> &#125;,</span><br><span class="line">			&#123; test : <span class="regexp">/\.less$/</span>, loader : <span class="string">"style!css!less"</span> &#125;,</span><br><span class="line">			&#123; test : <span class="regexp">/\.(jpg|png)$/</span>, loader : <span class="string">"url?limit=8192"</span> &#125;</span><br><span class="line">		]</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从上面可以看到，webpack的入口文件是entry.js，打包输出的文件是bundle.js，external属性是告诉webpack，当API已经存在的时候，使用全局变量，并不作任何操作。</p>
<p>loader的话没啥，看文档就知道，各种编译打包。具体使用方法可以看官方文档。</p>
<h4 id="上代码"><a href="#上代码" class="headerlink" title="上代码"></a>上代码</h4><figure class="highlight js"><figcaption><span>App.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'React'</span>),</span><br><span class="line">	ReactDOM = <span class="built_in">require</span>(<span class="string">'react-dom'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'../less/app.less'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> AppFooter = <span class="built_in">require</span>(<span class="string">'./AppFooter'</span>),</span><br><span class="line">	AppHeader = <span class="built_in">require</span>(<span class="string">'./AppHeader'</span>),</span><br><span class="line">	ItemMain = <span class="built_in">require</span>(<span class="string">'./ItemMain'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> App = React.createClass (&#123;</span><br><span class="line">	getInitialState : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			todoItem : [],</span><br><span class="line">			isAllChecked : <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">//添加todo</span></span><br><span class="line">	addItem : <span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> todoList = <span class="keyword">this</span>.state.todoItem.push(item);</span><br><span class="line">		<span class="keyword">this</span>.setState(&#123;isAllChecked : <span class="literal">false</span>&#125;);</span><br><span class="line">		<span class="keyword">this</span>.forceUpdate();</span><br><span class="line">	&#125;,</span><br><span class="line">	 <span class="comment">//更改todo状态</span></span><br><span class="line">	changeTodoState : <span class="function"><span class="keyword">function</span>(<span class="params">index, isDone, isAllChange</span>) </span>&#123;</span><br><span class="line">		<span class="comment">// isAllChange = false;</span></span><br><span class="line">		<span class="keyword">if</span>(isAllChange) &#123;</span><br><span class="line">			<span class="keyword">this</span>.setState(&#123;</span><br><span class="line">				todoItem: <span class="keyword">this</span>.state.todoItem.map(<span class="function"><span class="keyword">function</span>(<span class="params">todo</span>) </span>&#123;</span><br><span class="line">					todo.isDone = isDone;</span><br><span class="line">					<span class="keyword">return</span> todo;</span><br><span class="line">				&#125;),</span><br><span class="line">				isAllChecked : isDone</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">this</span>.state.todoItem[index].isDone = isDone;</span><br><span class="line">			<span class="keyword">this</span>.allChecked();</span><br><span class="line">			<span class="keyword">this</span>.forceUpdate();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">//删除todo</span></span><br><span class="line">	deleteTodo : <span class="function"><span class="keyword">function</span>(<span class="params">index</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> newTodo = <span class="keyword">this</span>.state.todoItem.splice(index, <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">this</span>.setState(&#123;todoList: newTodo&#125;);</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">//清楚已完成</span></span><br><span class="line">	clearDone : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> doneList = <span class="keyword">this</span>.state.todoItem.filter(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> item.isDone === <span class="literal">false</span>;</span><br><span class="line">		&#125;)</span><br><span class="line">		<span class="keyword">this</span>.setState(&#123;todoItem: doneList, isAllChecked: <span class="literal">false</span>&#125;);</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">//全部完成</span></span><br><span class="line">	allChecked : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> allCheck = <span class="keyword">this</span>.state.todoItem.every(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> item.isDone === <span class="literal">true</span>;</span><br><span class="line">		&#125;)</span><br><span class="line">		<span class="keyword">if</span> (allCheck) &#123;</span><br><span class="line">			<span class="keyword">this</span>.setState(&#123;isAllChecked : <span class="literal">true</span>&#125;)</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;,</span><br><span class="line">    	render : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    		<span class="keyword">var</span> props = &#123;</span><br><span class="line">    			todoLength : <span class="keyword">this</span>.state.todoItem.length || <span class="number">0</span>,</span><br><span class="line">    			doneLength : <span class="keyword">this</span>.state.todoItem.filter(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">    				<span class="keyword">return</span> item.isDone === <span class="literal">true</span>;</span><br><span class="line">    			&#125;).length || <span class="number">0</span></span><br><span class="line">    		&#125;;</span><br><span class="line">    	    	<span class="keyword">return</span> (</span><br><span class="line">    	        	&lt;div className="panel"&gt;</span><br><span class="line">    	        		&lt;header  className="mainHeader"&gt;&lt;h2&gt;Webpack + React TODO Demo&lt;/h2&gt;&lt;/header&gt;</span><br><span class="line">    	        		&lt;AppHeader addItem=&#123;this.addItem&#125;/&gt;</span><br><span class="line">    	        		&lt;ItemMain itemList=&#123;this.state.todoItem&#125; changeTodoState=&#123;this.changeTodoState&#125; deleteTodo=&#123;this.deleteTodo&#125; /&gt;</span><br><span class="line">    	        	    	&lt;AppFooter &#123;...props&#125; isAllChecked=&#123;this.state.isAllChecked&#125; clearDone=&#123;this.clearDone&#125; changeAllState=&#123;this.changeTodoState&#125; /&gt;</span><br><span class="line">    	        	&lt;/div&gt;</span><br><span class="line">    	    	)</span><br><span class="line">    	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">ReactDOM.render(&lt;App/&gt;, document.getElementById("app"));  //渲染</span><br></pre></td></tr></table></figure>
<p>从代码上面可以看到各种require，没加载commonjs、seajs或其他模块化工具，为什么能直接require呢，而且还有require less，没错，webpack就是那么暴力！js后面都会打包好一个文件，样式都会加载到html里面，做spa时候，和react简直绝配。</p>
<h4 id="App生命-state"><a href="#App生命-state" class="headerlink" title="App生命 - state"></a>App生命 - state</h4><p>React主流思想就是父组件控制state，然后通过props传递给子组建，所以简单来说界面就像状态机，只要更新state，然后根据新的state重新渲染界面，不需要操作dom，所以react高性能原因也是因为这个。<br>从最上代码就可以看出父组件中的定义的方法基本是整个todo的功能了，然后render方法即渲染html和组件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ItemMain itemList=&#123;<span class="keyword">this</span>.state.todoItem&#125; changeTodoState=&#123;<span class="keyword">this</span>.changeTodoState&#125; deleteTodo=&#123;<span class="keyword">this</span>.deleteTodo&#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>然后取一小段渲染组件代码（上面代码）就可发现，父组件向ItemMain这个组件传了4个属性，其中itemList为state，只要todoItem一更新，react就会重新渲染这个组件，其他三个为方法，方法更新也会重新渲染组件。</p>
<figure class="highlight js"><figcaption><span>ItemMain.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'React'</span>);</span><br><span class="line"><span class="keyword">var</span> Items = <span class="built_in">require</span>(<span class="string">'./Items'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ItemMain = React.createClass(&#123;</span><br><span class="line">	render : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">			&lt;section&gt;</span><br><span class="line">				&lt;ul className="itemList"&gt;</span><br><span class="line">					&#123;_this.props.itemList.map(function (todo, index) &#123;</span><br><span class="line">						return (</span><br><span class="line">							&lt;Items &#123;...todo&#125; key=&#123;index&#125; index=&#123;index&#125; &#123;..._this.props&#125; /&gt;</span><br><span class="line">						)</span><br><span class="line">					&lt;!-- &#125;)&#125; --&gt;</span><br><span class="line">					&lt;!--这里不注释代码不高亮，比较奇葩，各位官人将就着看--&gt;</span><br><span class="line">				&lt;/ul&gt;</span><br><span class="line">			&lt;/section&gt;</span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">module.exports = ItemMain;</span><br></pre></td></tr></table></figure>
<p>看这里估计有点蒙，我自己看的时候也有点蒙，因为太久的代码了哈哈哈。<br>这个js只有一个循环Item的逻辑，首先看看<code>{...todo}</code>这个prop，这个是把itemList[i]中的<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment" target="_blank" rel="external">数组对象解构</a>，然后传到item里面，如果没有…这个字符，则需要<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Items text=&#123;props.text&#125; isDone=&#123;props.isDone&#125; key=&#123;index&#125; index=&#123;index&#125; changeTodoState=&#123;proprs.changeTodoState&#125; deleteTodo=&#123;props.deleteTodo&#125; /&gt;</span><br></pre></td></tr></table></figure><br>具体数据大家可以在代码里面console打印一下，这样印象会更深。</p>
<figure class="highlight js"><figcaption><span>Item.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'React'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Items = React.createClass(&#123;</span><br><span class="line">	handleChange : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> isDone = !<span class="keyword">this</span>.props.isDone;</span><br><span class="line">		<span class="keyword">this</span>.props.changeTodoState(<span class="keyword">this</span>.props.index, isDone);</span><br><span class="line">	&#125;,</span><br><span class="line">	handleDeleteTodo : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.props.deleteTodo(<span class="keyword">this</span>.props.index);</span><br><span class="line">	&#125;,</span><br><span class="line">	render : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> doneStyle = <span class="keyword">this</span>.props.isDone ? &#123;textDecoration: <span class="string">'line-through'</span>&#125; : &#123;textDecoration : <span class="string">'none'</span>&#125;;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">			&lt;li key=&#123;this.props.key&#125; onMouseOver=&#123;this.handlerMouseOver&#125; onMouseOut=&#123;this.handlerMouseOut&#125;&gt;</span><br><span class="line">				&lt;input type="checkbox" checked=&#123;this.props.isDone&#125; onChange=&#123;this.handleChange&#125; /&gt;</span><br><span class="line">				&lt;span style=&#123;doneStyle&#125;&gt;&#123;this.props.text&#125;&lt;/span&gt;</span><br><span class="line">				&lt;button className="btn btn-default delete-item" onClick=&#123;this.handleDeleteTodo&#125;&gt;delete&lt;/button&gt;</span><br><span class="line">			&lt;/li&gt;</span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">module.exports = Items;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这个就是js里面有两个方法，一个是改变状态，一个是删除当前todo，这这能发现，两个方法都是执行了又父组件传过来的方法，如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.props.changeTodoState(<span class="keyword">this</span>.props.index, isDone);</span><br></pre></td></tr></table></figure></p>
<p>执行这个函数，state就会更新，react就会根据状态重新渲染组件</p>
<h4 id="其他组件"><a href="#其他组件" class="headerlink" title="其他组件"></a>其他组件</h4><figure class="highlight js"><figcaption><span>AppHeader.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'React'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> AppHeader = React.createClass(&#123;</span><br><span class="line">	getInitialState : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			text : <span class="string">""</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	handlerKeyUp : <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(event.keyCode === <span class="number">13</span>) &#123;</span><br><span class="line">			<span class="keyword">var</span> value = event.target.value;</span><br><span class="line">			<span class="keyword">if</span>(!value) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">var</span> newTodoItem = &#123;</span><br><span class="line">				text : value,</span><br><span class="line">				isDone : <span class="literal">false</span></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			event.target.value = <span class="string">""</span>;</span><br><span class="line">			<span class="keyword">this</span>.setState(&#123;text: <span class="string">""</span>&#125;);</span><br><span class="line">			<span class="keyword">this</span>.props.addItem(newTodoItem);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	handleChange : <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.setState(&#123;text : event.target.value &#125;);</span><br><span class="line">	&#125;,</span><br><span class="line">	handlerClick : <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> newTodoItem = &#123;</span><br><span class="line">			text : <span class="keyword">this</span>.state.text,</span><br><span class="line">			isDone : <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.props.addItem(newTodoItem);</span><br><span class="line">		<span class="keyword">this</span>.setState(&#123;text: <span class="string">""</span>&#125;);</span><br><span class="line">	&#125;,</span><br><span class="line">	render : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">			&lt;section className="appHeader from-group"&gt;</span><br><span class="line">				&lt;input type="test" className="form-control" onKeyUp=&#123;this.handlerKeyUp&#125; onChange=&#123;this.handleChange&#125; placeholder="add one todo" value=&#123;this.state.text&#125;/&gt;</span><br><span class="line">				&lt;button className="btn btn-primary" onClick=&#123;this.handlerClick&#125;&gt;add one&lt;/button&gt;</span><br><span class="line">			&lt;/section&gt;</span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">module.exports = AppHeader;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>AppHeader.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'React'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> AppFooter = React.createClass(&#123;</span><br><span class="line">	handleClick : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.props.clearDone();</span><br><span class="line">	&#125;,</span><br><span class="line">	handleAllState : <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.props.changeAllState(<span class="literal">null</span>, event.target.value, <span class="literal">true</span>);</span><br><span class="line">	&#125;,</span><br><span class="line">	render : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">			&lt;section className="appFooter"&gt;</span><br><span class="line">				&lt;div&gt;</span><br><span class="line">					&lt;input type="checkbox" checked=&#123;this.props.isAllChecked&#125; onChange=&#123;this.handleAllState&#125;/&gt;</span><br><span class="line">					&lt;span&gt;&#123;this.props.doneLength&#125;&lt;/span&gt;已经完成 / &lt;span&gt;&#123;this.props.todoLength&#125;&lt;/span&gt;总数</span><br><span class="line">				&lt;/div&gt;</span><br><span class="line">				&lt;button className="btn btn-default btn-tiny pull-right" onClick=&#123;this.handleClick&#125;&gt;clean done&lt;/button&gt;</span><br><span class="line">			&lt;/section&gt;</span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">module.exports = AppFooter;</span><br></pre></td></tr></table></figure>
<p>Header Footer的方法都是大同小异，输入改变state，然后存起来，执行相应操作时候通过props的方法传给父组件，然后重新渲染界面。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>回头看代码，react的组件化相比现在的组件化思想真的先进很多。React通过父组件来控制状态，并通过props传递给子组件。因此我们能很容易看出我们的事件属于哪个组件管理，然后修改相应的方法，维护起来相当高效，相比现在的控制dom，每次修改按钮的方法，都需要先找到id或者class，然后绑定响应的方法，假如页面id或者class改变，页面逻辑又非常复杂的话，修改起来是相当麻烦的。<br>React凭着出色的设计思想和性能，我相信不久就会成为主流的移动端开发方式，至于PC端，大天朝你懂的。</p>
</article></div></main><div class="page-footer"><div class="post-pagination"><a href="/Circle_Talk/2016/03/01/hello-world/">Hello World!<i class="ion-arrow-right-c"></i></a></div></div><script src="http://cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script><script>window.jQuery || document.write('<script src="js/vendor/jquery-1.9.0.min.js"><\/script>')</script><script src="/Circle_Talk/js/post.min.js"></script></body></html>